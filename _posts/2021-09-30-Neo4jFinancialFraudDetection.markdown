---
layout: post
title: "图数据科学在金融欺诈检测方面的应用"
subtitle: "本篇文章是对Neo4j官网上'Financial Fraud Detection with Graph Data Science'的翻译"
date: 2021-09-30
author: 七月
category: 技术文档
tags: 图数据库 算法  翻译
finished: false
---

## 简介

金融欺诈近年来正在日益增长，是一个代价高昂的问题，2019年所耗费费用约占GDP的6%，超过了5万亿美元。尽管使用了越来越复杂的欺诈检测工具——通常利用人工智能和机器学习，企业每年还是会在金融骗局中损失越来越多的钱。图数据科学有助于扭转这种局面。

通过提高已有的分析方法和机器学习管道，一门图数据科学方法提升了金融欺诈检测方法的准确率和和可行性，使得有更少的欺诈交易和更安全的收入来源。

在这篇白皮书中，我们将进一步解释数据科学和欺诈检测团队可以如何利用图形技术的力量，在第一方欺诈和复杂的诈骗团伙上面进行更高质量的检测。

## 金融欺诈检测的挑战

欺诈犯会不断升级他们的作案工具和作案手法，因此我们需要时刻保持警惕来避免经济损失。

以美国发展最快的一种金融诈骗——[身份盗窃为例](https://fedpaymentsimprovement.org/wp-content/uploads/frs-synthetic-identity-payments-fraud-white-paper-july-2019.pdf)。诈骗者将各种假的和真的元素（如地址，电话、邮箱、雇主等）融合在一起转换成一个合成身份，然后使用它们达到欺诈的目的。合成身份经常冒充为真实身份。而根据ID分析，传统的欺诈检测技术会漏掉85%的合成身份。

于此同时，欺诈团伙——无论大小——都在增多。由于欺诈涉及到多方，相应的损失也急剧上升。在提交给国家的2018年的报告中，注册舞弊协查员协会（ACFE)发现，诈骗者的数量和诈骗事件造成的损失两者之间存在直接的联系，从平均74000美元一个人上升到339000美元一个人当同时有3或3名以上的成员时。就像群体猎人，当骗子一起工作时威胁更大。

这个问题就变为在面对这些挑战时如何能够降低损失。

## 为什么目前的技术无法检测所有的欺诈

数据科学家们已经研究了很多机器学习分析模型来检测欺诈。然而，大多数数据科学模型忽略了一些重要的因素：网络结构。

社会网络分析的研究强调了分析网络结构的预测能力。正如James Fowler在他的《Connected》一书中所说，”我们越来越了解到，相比通过他们自己的相关信息，通过他们的朋友以及朋友的朋友的信息你可以做出有关他们的更好的预测。”

网络分析捕捉了数据元素之间的内在关系。我们习惯性地认为社会网络是一个图。事实上，任何数据都可以用图来表示。例如，可以将账户所有者和他们的信息可视化为图的形式。

当你分析账户所有者信息的网络结构时，你会看见（如下图所示）多个账户所有者有相同的手机号或者相同的身份号码。共享相同的元素可能表示存在合成身份欺诈。如果没有有效的方法来检测这种由成百上千、成千上万的账户构成的网络，这些欺诈现象将很难被发现。

表格数据模型，用行和列的形式表示数据，不能用来捕获数据中的复杂关系和网络结构。

将数据作为图标进行分析，可以揭示并使用其结构进行预测。您可以持久化使用这些链接，以便稍后进行分析。

![image-20210930144026072](/Users/Rosanne/Documents/GitHub/Rosanne-Luo.github.io/img/2021-09-30-Neo4jFinancialFraudDetection//image-20210930144026072.png)

## 欺诈检测领域的图形数据科学

图形数据科学让你可以通过搜索、查询和图算法探索和分析网络结构。虽然图形数据科学是借鉴了图论（离散数据的一个子领域），但是你不需要有学术背景就能从中收益。

图数据科学提高了欺诈检测的准确率。由于欺诈耗费巨大且问题的规模巨大，金融服务公司使用图形数据科学作出报告，即使是提升一点点精读也能节省数百万美元。一个大的金融服务行业的Neo4j客户生成在使用Neo4j的头几个月里，就发现了数千万美元的欺诈行为。

改进的预测精读来自于图分析和图特征工程。一旦数据连接到图形数据库中，就有可能从连接相关的指标建立图形特征，例如进入或者离开的关系的数量或者共同的潜在三角形或者邻居的数量。社区检测算法会在你的数据中突出分组，这样就可以调查可能的欺诈环和挖掘到不寻常的模式。

用图形数据科学解锁你的网络结构数据，扩充你当前的模型。

通过图形数据科学，你可以在不用修改机器学习管道的前提下检测出已有数据的更多的欺诈。通过用这种方式分析历史数据，你可能会发现一些可以恢复的欺诈，增加上限收益。一旦发现欺诈的机箱，在实时欺诈监测系统中合并他们，以遏制未来的此类损失。

![image-20210930145848813](/Users/Rosanne/Documents/GitHub/Rosanne-Luo.github.io/img/2021-09-30-Neo4jFinancialFraudDetection//image-20210930145848813.png)

## 三种使用图形数据科学的方式

为了分析数据的网络结构，需要像Neo4j一样复制一份数据到图数据库里。在你学习数据的拓扑逻辑和它的内在的联系之前，你需要图结构形式的数据。

这里有三种使用图数据来发现更多欺诈的方式。

### 探索关系的图搜索和图查询

对于图数据库中的连接的数据，第一步是进行图的搜索和查询以探索关系。例如，该领域的专家可能会写一个查询来识别具有相同属性（如电话号码，相同IP或者相同的邮箱）的账户所有者。使用Cypher语言，只要几行代码就可以实现需要大量复杂的SQL代码才能实现的功能。考虑下面这个示例，cypher查询返回了从一个结点到另一个邮箱组或者电话组的最短距离。这个查询是其他几个分析的七点，如果起始节点是欺诈者，那么附近的结点也可能是欺诈者或者欺诈的目标。

![image-20210930161617259](/Users/Rosanne/Documents/GitHub/Rosanne-Luo.github.io/img/2021-09-30-Neo4jFinancialFraudDetection//image-20210930161617259.png)

此外，一个数据可视化工具例如Neo4j Bloom 让你可以可视化地探索图数据集，使用code-free 和预配置检索来查询数据，还有与其他团队共享可视化的观点。

### 用于发现的图分析

第二步是使用图查询和算法对数据做进一步的深入探索，以便了解它的结构，发现其模式和异常的地方。

![image-20210930162423008](/Users/Rosanne/Documents/GitHub/Rosanne-Luo.github.io/img/2021-09-30-Neo4jFinancialFraudDetection//image-20210930162423008.png)

当你知道你要找的是什么——比如确定某人是否在一个已知的欺诈者的扩展网络中——图形查询工作做得很好。然而，当你找到了你正在寻找的一般结构，但不是确切的模式时，考虑使用图算法。

一个图算法是专门为执行某种复杂地分析而编写的代码，通常将一个图数据集作为一个整体看待。

在运行一个社区检测算法后，例如，一个数据科学家可能会将结果交个分析师，以调查账户之间是否存在紧密的联系（暗示可能的欺诈环），另一种诈骗模式或者一些完全不同的东西如特定地区内的客户忠诚度。

[Neo4j图形数据科学库](https://neo4j.com/graph-machine-learning-algorithms/?ref=pdf-white-paper-ai-fraud-detection)包括了优化的企业可伸缩的图形算法以针对Neo4j中的连接数据。这个库向数据科学家和分析师提供了企业级的方法来运行图形算法以针对规模的连接数据。

![image-20210930163410997](/Users/Rosanne/Documents/GitHub/Rosanne-Luo.github.io/img/2021-09-30-Neo4jFinancialFraudDetection//image-20210930163410997.png)

### 图特征工程

使用图算法和查询，数据科学家找到了能够预测诈骗的特征，并将特征添加到他们的机器学习模型中。例如，在使用了社区检测算法发现异常的紧密社区，并且经过调查人员调查后发现了欺诈环的特征，我们可以提取整个数据集相关的图特征，并将这些特征放入分类器模型中以显著提高现有有欺诈检测策略的预测精度。

Neo4j 图形数据科学库的灵活性、移动性和扩展性允许数据科学家们在将模型投入生产前，快速实验多种方法以验证最具有预测性的特征。

图特征可以像节点的社区ID或者中心性度量一样简单，或者可以包括描述一个社区的复杂的统计数据，与已知的欺诈账户的接近度，与已知标记的欺诈的相似关系模式，或者任何其他描述性的网络属性。特征可以存储为节点或者关系属性，或者可以直接流化到另一个模型开发环境中。当图被更新时，算法可以在需要时利用之前播种的结果，重新运行、不断地重新训练图模型以获取最大的一致性和计算效率。

通过利用现有的ML模型、方法和图特征，数据科学家们利用网路结构和关系的预测能力，而不需要改变经过验证和很好理解的方法。

我们可以演示如何使用PaySim合成移动传输数据集的一个变体预测拓扑逻辑。下面来自Neo4j Bloom的屏幕截图显示了通过运行一个社区检测算法，找到了不寻常的活动岛屿。

在这张图中，我们看见一个“可疑的”群体（人们共享邮箱/电话/识别码）。中间中心度（大黄）高的人更有可能是骡子。

![image-20210930165408879](/Users/Rosanne/Documents/GitHub/Rosanne-Luo.github.io/img/2021-09-30-Neo4jFinancialFraudDetection//image-20210930165408879.png)

可视化地探索图可疑帮助分析人员更加直观地了解要研究什么以及哪些元素是可预测的。这种类型的结构信息可以用于特征工程，并被提取为一个表格的形式给机器学习来预测一个人是否是欺诈者。下表显示了一个客户端样本，他们的中间性中心得分，他们与他人共享的标识数，基于共享内容的加权得分，最后预测他们是否是一个诈骗者。

![image-20210930170140599](/Users/Rosanne/Documents/GitHub/Rosanne-Luo.github.io/img/2021-09-30-Neo4jFinancialFraudDetection//image-20210930170140599.png)

在这个表中，我们看到William Roach 和好几个家庭成员共享一个电子邮件地址，这不是很可疑。Kaylee Roach 人脉很广，与其他人共享了多个信息，因此该模型预测她是一个骗子。Elizabeth Drake 和 Kaylee 共用一个社会安全号码，光是这个危险信号就足以预测她可能是一个骗子。

请注意，Nicholas Olson 没有显示在截图中国，因为真实的网络会包含比上图中多得多的客户。

## 使用图特征工程提高欺诈检测